Could not retrieve detailed voice properties: 'NoneType' object has no attribute 'decode'
Traceback (most recent call last):
  File "/app/tts_manager.py", line 35, in _initialize_engine
    current_voice_id = self.engine.getProperty('voice')
  File "/home/swebot/.local/lib/python3.10/site-packages/pyttsx3/engine.py", line 149, in getProperty
    return self.proxy.getProperty(name)
  File "/home/swebot/.local/lib/python3.10/site-packages/pyttsx3/driver.py", line 176, in getProperty
    return self._driver.getProperty(name)
  File "/home/swebot/.local/lib/python3.10/site-packages/pyttsx3/drivers/espeak.py", line 84, in getProperty
    return fromUtf8(voice.contents.name)
  File "/home/swebot/.local/lib/python3.10/site-packages/pyttsx3/drivers/__init__.py", line 23, in fromUtf8
    return value.decode('utf-8')
AttributeError: 'NoneType' object has no attribute 'decode'
2025-06-12 14:50:24,678 - INFO     - __main__                  - Application starting...
2025-06-12 14:50:24,687 - ERROR    - __main__                  - Tkinter TclError occurred: no display name and no $DISPLAY environment variable
Traceback (most recent call last):
  File "/app/main_app.py", line 1050, in <module>
    root = bs.Window(themename="solar")
  File "/home/swebot/.local/lib/python3.10/site-packages/ttkbootstrap/window.py", line 235, in __init__
    super().__init__(**kwargs)
  File "/home/swebot/.local/lib/python3.10/site-packages/ttkbootstrap/style.py", line 5318, in __init__wrapper
    func(self, *args, **kwargs)
  File "/usr/lib/python3.10/tkinter/__init__.py", line 2302, in __init__
    self.tk = _tkinter.create(screenName, baseName, className, interactive, wantobjects, useTk, sync, use)
_tkinter.TclError: no display name and no $DISPLAY environment variable
2025-06-12 14:50:24,704 - INFO     - __main__                  - No display found, attempting to run in HEADLESS test mode.
2025-06-12 14:50:24,704 - INFO     - __main__                  - Initializing TaskManagerApp in HEADLESS mode.
2025-06-12 14:50:24,704 - INFO     - __main__                  - UI setup and UI-based queue polling skipped in HEADLESS mode.
2025-06-12 14:50:24,704 - INFO     - __main__                  - Initializing scheduler...
2025-06-12 14:50:24,705 - DEBUG    - tzlocal                   - /etc/timezone found, contents:
 Etc/UTC

2025-06-12 14:50:24,705 - DEBUG    - tzlocal                   - /etc/localtime found
2025-06-12 14:50:24,709 - DEBUG    - tzlocal                   - 2 found:
 {'/etc/timezone': 'Etc/UTC', '/etc/localtime is a symlink to': 'Etc/UTC'}
2025-06-12 14:50:24,711 - INFO     - apscheduler.scheduler     - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-12 14:50:24,711 - INFO     - scheduler_manager         - Job 'job_check_repetition' (target: check_repeating_tasks) configured with interval: 1 hour.
2025-06-12 14:50:24,711 - INFO     - apscheduler.scheduler     - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-12 14:50:24,711 - INFO     - scheduler_manager         - Job 'job_rescheduler_reminders' (target: schedule_task_reminders) configured with interval: 5 minutes.
2025-06-12 14:50:24,713 - INFO     - apscheduler.scheduler     - Added job "check_repeating_tasks" to job store "default"
2025-06-12 14:50:24,713 - INFO     - apscheduler.scheduler     - Added job "schedule_task_reminders" to job store "default"
2025-06-12 14:50:24,713 - INFO     - apscheduler.scheduler     - Scheduler started
2025-06-12 14:50:24,714 - DEBUG    - apscheduler.scheduler     - Looking for jobs to run
2025-06-12 14:50:24,714 - INFO     - scheduler_manager         - BackgroundScheduler initialized and started.
2025-06-12 14:50:24,714 - DEBUG    - apscheduler.scheduler     - Next wakeup is due at 2025-06-12 14:55:24.711299+00:00 (in 299.996716 seconds)
2025-06-12 14:50:24,714 - INFO     - scheduler_manager         - Performing initial scan and scheduling of reminders...
2025-06-12 14:50:24,715 - INFO     - scheduler_manager         - Scheduler job 'schedule_task_reminders' started.
2025-06-12 14:50:24,719 - INFO     - scheduler_manager         - Fetched 1 tasks from DB for reminder scheduling.
2025-06-12 14:50:24,719 - DEBUG    - scheduler_manager         - Processing task for reminder: ID=1, Title='Daily Task A 1AM', Due='2025-06-09T01:00:00', Rep='Daily', Status='Pending'
2025-06-12 14:50:24,720 - DEBUG    - scheduler_manager         - Scheduling CRON job ID reminder_1 for task 'Daily Task A 1AM' (TaskID: 1). Trigger: cron, Params: {hour=1, minute=0, start_date=2025-06-09T01:00:00}
2025-06-12 14:50:24,727 - INFO     - apscheduler.scheduler     - Added job "trigger_reminder_action" to job store "default"
2025-06-12 14:50:24,727 - INFO     - scheduler_manager         - Scheduled reminder for Task 'Daily Task A 1AM' (ID: 1). Trigger: {'trigger': 'cron', 'start_date': datetime.datetime(2025, 6, 9, 1, 0), 'hour': 1, 'minute': 0}
2025-06-12 14:50:24,728 - DEBUG    - scheduler_manager         - Currently 3 jobs in scheduler. Checking for stale reminder jobs...
2025-06-12 14:50:24,728 - INFO     - scheduler_manager         - Scheduler job 'schedule_task_reminders' completed. Tasks processed: 1. New reminders: 1, Updated: 0, Skipped (past one-time): 0, Skipped (no trigger): 0, Removed stale: 0.
2025-06-12 14:50:24,728 - DEBUG    - scheduler_manager         - Current scheduler jobs:
  - ID: job_rescheduler_reminders, Next Run: 2025-06-12 14:55:24.711299+00:00, Trigger: interval[0:05:00]
  - ID: job_check_repetition, Next Run: 2025-06-12 15:50:24.710804+00:00, Trigger: interval[1:00:00]
  - ID: reminder_1, Next Run: 2025-06-13 01:00:00+00:00, Trigger: cron[hour='1', minute='0']
2025-06-12 14:50:24,728 - DEBUG    - scheduler_manager         - DB connection closed after schedule_task_reminders.
2025-06-12 14:50:24,728 - INFO     - __main__                  - Scheduler initialized successfully.
2025-06-12 14:50:24,728 - INFO     - __main__                  - TaskManagerApp initialization complete.
2025-06-12 14:50:24,728 - INFO     - __main__                  - Running in HEADLESS test mode. Scheduler and queue processing active.
2025-06-12 14:50:24,728 - INFO     - __main__                  - Application will simulate running for up to 5 minutes. Press Ctrl+C to interrupt.
2025-06-12 14:50:24,729 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:24,729 - DEBUG    - apscheduler.scheduler     - Looking for jobs to run
2025-06-12 14:50:24,729 - DEBUG    - apscheduler.scheduler     - Next wakeup is due at 2025-06-12 14:55:24.711299+00:00 (in 299.982074 seconds)
2025-06-12 14:50:24,979 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:25,230 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:25,480 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:25,731 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:25,982 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:26,232 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:26,483 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:26,734 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:26,984 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:27,235 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:27,486 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:27,736 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:27,990 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:28,240 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:28,493 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:28,743 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:28,994 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:29,245 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:29,496 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:29,746 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:29,997 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:30,248 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:30,499 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:30,750 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:31,000 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:31,251 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:31,502 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:31,752 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:32,003 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:32,254 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:32,505 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:32,755 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:33,006 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:33,257 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:33,508 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:33,758 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:34,009 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:34,260 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:34,510 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:34,761 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:35,012 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:35,262 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:35,513 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:35,764 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:36,014 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:36,265 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:36,516 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:36,766 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:37,017 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:37,267 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:37,518 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:37,769 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:38,020 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:38,270 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:38,521 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:38,772 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:39,023 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:39,273 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:39,524 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:39,775 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:40,025 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:40,276 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:40,527 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:40,777 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:41,028 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:41,279 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:41,529 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:41,780 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:42,031 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:42,282 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:42,532 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:42,783 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:43,034 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:43,284 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:43,535 - DEBUG    - __main__                  - Checking reminder queue...
2025-06-12 14:50:43,786 - DEBUG    - __main__                  - Checking reminder queue...
